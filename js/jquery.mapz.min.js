/** @Preserve
*	jQuery Mapz v1.0
*
*	by Danny van Kooten - http://dannyvankooten.com
*	Last Modification: 20/06/2011
*
*	For more information, visit:
*	http://dannyvankooten.com/jquery-plugins/mapz/
*
*	Licensed under the Creative Commons Attribution 2.5 License - http://creativecommons.org/licenses/by/2.5/
*		- Free for use in both personal and commercial projects
*		- Attribution requires leaving author name, author link, and the license info intact.	
*/
!function(e){e.fn.mapz=function(t){function i(){s.css({left:-a.width()+h.width(),top:-a.height()+h.height(),width:2*a.width()-h.width(),height:2*a.height()-h.height()}),a.position().left<s.position().left&&a.css("left",s.position().left),a.position().top<s.position().top&&a.css("top",s.position().top),s.width()<=a.width()&&s.height()<=a.height()?a.css("cursor","default"):a.css("cursor","all-scroll")}function n(e){var t=a.children(".current-level");switch(e){case"in":if(0==a.children(".current-level").next().length)return;var i=t.next();break;case"out":if(0==a.children(".current-level").prev().length)return;var i=t.prev()}i.addClass("current-level"),t.removeClass("current-level"),o(i,t)}function o(e,t){var n=a.position(),o=h.width()/2,r=h.height()/2,s=-n.left,c=-n.top,l=e.width()/t.width()*(s+o)-o,d=e.height()/t.height()*(c+r)-r;l<0&&(l=0),d<0&&(d=0),a.css({left:-l,top:-d,width:e.width(),height:e.height()}),i()}var r={zoom:!1,createmaps:!1,mousewheel:!1,pinchzoom:!1};t&&e.extend(r,t);var h=this.parent(".map-viewport"),a=this,s=e(document.createElement("div")).addClass("mapz-constraint").css("position","absolute").appendTo(h);a.children(".level:first").addClass("current-level");var c=a.children(".current-level");if(o(c,c),r.zoom){if(e(document).keydown(function(e){return 38==e.keyCode?(n("in"),!1):40==e.keyCode?(n("out"),!1):void 0}),r.mousewheel&&a.bind("mousewheel",function(e,t){return n(t>0?"in":"out"),!1}),r.pinchzoom)if("function"==typeof Hammer){var l=0;this.hammer().on("pinchin",function(e){e.gesture.scale+l<.88&&(l+=.12,n("out"))}),this.hammer().on("pinchout",function(e){e.gesture.scale+l>1.12&&(l-=.12,n("in"))}),this.hammer().on("release",function(e){l=0})}else alert("pinchzoom cannot be turned on without hammer library");r.createmaps&&function(){var t=h.children("map"),i=1,n=0;a.children(".level").each(function(){if(n++,!e(this).hasClass("current-level")){i=e(this).width()/a.width();var o=e(document.createElement("map")).attr("name",a.attr("id")+"-map-"+n);t.children("area").each(function(){var t=e(this).clone(),n=e(this).attr("coords").split(",");for(var r in n)n[r]=Math.ceil(n[r]*i);t.attr("coords",n).appendTo(o)}),o.appendTo(h),e(this).attr("usemap","#"+a.attr("id")+"-map-"+n)}})}()}a.draggable({containment:s})}}(jQuery);